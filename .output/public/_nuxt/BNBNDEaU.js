import{_ as Re,a as Be}from"./CpONho9-.js";import{_ as me,a as de,b as fe,c as ue,d as _e,e as xe,f as ve}from"./Bv3Y1o13.js";import{m as W,r as _,g as ne,o as d,v as w,w as t,b as e,d as k,a,c as L,D as ae,E as te,t as q,p as o,H as oe,y as Ve,n as He,I as je,z as Z,J as qe,F as l,M as Ye,T as H,x as Q,q as j,A as ze,B as Je,C as Qe,G as We}from"./o_xHGJZu.js";import{_ as Xe}from"./CAVo-8-W.js";import{_ as Ze}from"./ZfbbDSqY.js";import{_ as es}from"./62m6YuF7.js";import{t as ss,u as as,_ as ts,a as ns,F as os}from"./8MsBM-Q2.js";import{_ as ls,a as is,b as rs,c as cs,d as ps}from"./DX7gmgff.js";import{_ as ms,a as ds}from"./CCiwAwsW.js";import{_ as fs}from"./BTxsceTg.js";import{_ as us}from"./C-xb1J1t.js";import{_ as ye}from"./DlAUqK2U.js";import{_ as _s}from"./CREXV-kI.js";import{o as xs,s as ee,f as vs,a as se}from"./CoqBGt4Q.js";import{v as m,g as ys}from"./Crbu4M_9.js";import{u as gs}from"./DrkffsAD.js";import{u as bs}from"./DppYWb2n.js";import{L as ks}from"./sAVtE4SY.js";import{E as ce,a as pe}from"./CAG3GUeG.js";import"./DeLInf8T.js";import"./XhmMvoaH.js";const ws={class:"border border-gray-300 p-4 min-h-[150px]"},Ns={class:"flex flex-col gap-2"},Ps=W({__name:"confirm-update-customer",props:{isOpen:{type:Boolean},fields:{}},emits:["close","update"],setup(R,{emit:M}){const r=R,y=_(r.isOpen);ne(()=>r.isOpen,g=>{y.value=g});const N=M,C=()=>{N("close")},v=()=>{N("update")};return(g,f)=>{const x=me,F=de,$=fe,D=ue,A=_e,I=xe,K=ve;return d(),w(K,{open:o(y),"onUpdate:open":f[0]||(f[0]=h=>oe(y)?y.value=h:null)},{default:t(()=>[e(I,null,{default:t(()=>[e(F,{class:"flex flex-col gap-4"},{default:t(()=>[e(x,{class:"text-sm text-center"},{default:t(()=>f[1]||(f[1]=[k("変更の確認")])),_:1}),e(x,{class:"text-sm font-normal"},{default:t(()=>f[2]||(f[2]=[k("以下の内容を変更します。よろしいですか？")])),_:1})]),_:1}),a("div",ws,[a("ul",Ns,[(d(!0),L(ae,null,te(g.fields,h=>(d(),L("li",{key:h},q(h),1))),128))])]),e(A,{class:"flex !flex-col gap-4"},{default:t(()=>[e($,{class:"flex self-center min-w-[120px]",onClick:v},{default:t(()=>f[3]||(f[3]=[k("変更")])),_:1}),e(D,{class:"flex self-center border border-gray-300 min-w-[120px]",onClick:C},{default:t(()=>f[4]||(f[4]=[k("キャンセル")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}}),Cs=W({__name:"execution-confirm",props:{isOpen:{type:Boolean},activeStatus:{}},emits:["close","update"],setup(R,{emit:M}){const r=R,y=_(r.isOpen);ne(()=>r.isOpen,C=>{y.value=C});const N=M;return(C,v)=>{const g=me,f=de,x=fe,F=ue,$=_e,D=xe,A=ve;return d(),w(A,{open:o(y),"onUpdate:open":v[2]||(v[2]=I=>oe(y)?y.value=I:null),class:"delete-modal"},{default:t(()=>[e(D,null,{default:t(()=>[e(f,{class:"flex flex-col gap-6 items-center mb-4"},{default:t(()=>[e(g,{class:"text-sm"},{default:t(()=>v[3]||(v[3]=[k("実行の確認")])),_:1}),e(g,{class:"text-sm font-normal"},{default:t(()=>[k(q(C.activeStatus===1?"顧客の利用を停止します。よろしいですか？":"顧客の利用を再開します。よろしいですか？"),1)]),_:1})]),_:1}),e($,{class:"flex !flex-col gap-5"},{default:t(()=>[e(x,{class:"flex self-center min-w-[120px]",onClick:v[0]||(v[0]=I=>N("update"))},{default:t(()=>[k(q(C.activeStatus===1?"停止":"開始"),1)]),_:1}),e(F,{class:"flex self-center border border-gray-300 min-w-[120px]",onClick:v[1]||(v[1]=I=>N("close"))},{default:t(()=>v[4]||(v[4]=[k("キャンセル")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}}),hs=ye(Cs,[["__scopeId","data-v-98fde63d"]]),Ss={class:"login-page flex flex-col !h-[100vh] overflow-hidden relative"},Fs={class:"flex justify-between mt-[15px]"},$s={class:"form overflow-y-auto scroll"},Ds={class:"flex flex-col w-[900px] gap-[25px] pb-[20px]"},As={class:"company flex flex-col gap-5"},Is={class:"flex gap-5 items-center"},Os={class:"flex gap-5 items-center"},Us={class:"information flex flex-col gap-5"},Ks={class:"flex gap-5 items-center"},Gs={class:"flex gap-5 items-center"},Es={class:"flex flex-col gap-[15px] w-[82%]"},Ts={class:"flex gap-5 items-center !m-[0px]"},Ms={class:"pic-position flex gap-5 items-center w-[50%]"},Ls={class:"pic-name flex items-center gap-5 w-[50%]"},Rs={class:"flex gap-5 items-center !m-[0px]"},Bs={class:"pic-name flex items-center gap-5 w-[50%]"},Vs={class:"flex flex-col gap-[15px] w-[82%]"},Hs={class:"flex gap-5 items-center !m-[0px]"},js={class:"pic-position flex gap-5 items-center w-[50%]"},qs={class:"pic-name flex items-center gap-5 w-[50%]"},Ys={class:"flex gap-5 items-center !m-[0px]"},zs={class:"pic-name flex items-center gap-5 w-[50%]"},Js={class:"contact flex flex-col gap-6"},Qs={class:"flex gap-5 items-center"},Ws={class:"flex gap-5 items-center -mb-[12.5px]"},Xs={class:"flex gap-5 items-center"},Zs={class:"relative !m-[0px]"},ea={class:"relative"},sa={class:"flex gap-5 items-center"},aa={class:"!m-[0px]"},ta={class:"flex gap-5 items-center"},na={class:"flex gap-5 items-center"},oa={class:"flex gap-5 items-center"},la={class:"relative !m-[0px]"},ia={class:"relative"},ra={class:"relative w-[82%] !m-[0px]"},ca={class:"relative w-[82%] !m-[0px] flex gap-2 items-center"},pa={class:"flex max-w-[900px] justify-between py-[20px]"},ma={class:"flex gap-5"},da={class:"flex gap-5"},fa=W({__name:"index",setup(R){const M=Ve(),r=He(),y=je(),N=gs(),{redirectPage:C}=bs(),v=_(),g=_(""),f=_(!1),x=_(!1),F=_(0),$=_(!1),D=_(!1),A=_(!1),I=_({}),K=_([]),h=_(!1),Y=_(!1),G=_(!1),ge=Z(()=>{var n;return(n=M.masterData)==null?void 0:n.kaigoSoftwares}),B=Z(()=>N.companyUser),be=Z(()=>K.value.length==0),le=_(!1);qe(async()=>{if(x.value=!0,g.value=y.params.id,!g)return C("/customer");await N.getCompanyById(Number(g.value)),B.value&&(ke(),F.value=B.value.status),x.value=!1});const ke=()=>{if(B.value){const n=B.value;i("companyName",n.companyName),i("companyNameKana",n.companyNameKana),i("companyPostCode",n.companyPostCode),i("companyAddress",n.companyAddress),i("phoneNumber",n.phoneNumber),i("picFamilyName",n.picFamilyName),i("picFamilyNameKana",n.picFamilyNameKana),i("picGivenName",n.picGivenName),i("picGivenNameKana",n.picGivenNameKana),i("picPosition",n.picPosition),i("frontPicFamilyName",n.frontPicFamilyName),i("frontPicFamilyNameKana",n.frontPicFamilyNameKana),i("frontPicGivenName",n.frontPicGivenName),i("frontPicGivenNameKana",n.frontPicGivenNameKana),i("frontPicPosition",n.frontPicPosition),i("kaipokeUserId",n.kaipokeUserId),i("kaipokeUserPassword",n.kaipokeUserPassword),i("kaipokeCompanyId",n.kaipokeCompanyId),i("paymentMethod",n.paymentMethod),i("kaigoSoftware",n.kaigoSoftware.toString()),i("email",n.email),G.value=n.keepLastPlanContentFlg==1,I.value={...O}}},we=ss(xs({companyName:m(l.companyName,250),companyNameKana:m(l.companyNameKana,250,!0),companyPostCode:m(l.companyPostCode,10),companyAddress:m(l.companyAddress,250),frontPicPosition:m(l.frontPicPosition,100),frontPicFamilyName:m(l.frontPicFamilyName,100),frontPicGivenName:m(l.frontPicGivenName,100),frontPicFamilyNameKana:m(l.frontPicFamilyNameKana,100,!0),frontPicGivenNameKana:m(l.frontPicGivenNameKana,100,!0),picPosition:m(l.picPosition,100),picFamilyName:m(l.picFamilyName,100),picGivenName:m(l.picGivenName,100),picFamilyNameKana:m(l.picFamilyNameKana,100,!0),picGivenNameKana:m(l.picGivenNameKana,100,!0),phoneNumber:m(l.phoneNumber,20),email:m(l.email,250),password:ys().optional(),kaigoSoftware:ee(vs(Ye.ERR002,l.kaigoSoftware)).min(1,se(l.kaigoSoftware)),kaipokeCompanyId:m(l.kaipokeCompanyId,100),kaipokeUserId:m(l.kaipokeUserId,100),kaipokeUserPassword:ee(se(l.kaipokeUserPassword)).min(1,se(l.kaipokeUserPassword)),paymentMethod:ee().nullable().optional()})),{handleSubmit:Ne,values:O,setFieldValue:i}=as({validationSchema:we}),Pe=()=>{Y.value=!Y.value},Ce=()=>{h.value=!h.value},he=async()=>{const n=O==null?void 0:O.companyPostCode;if(!n){r.setNotify({message:"郵便番号が存在しません。",type:H.error});return}f.value=!0;const s=await r.searchPostalCode(n);if(s!=null&&s.data){const{prefecture:b,city:S}=s.data,c=`${b} ${S}`;i("companyAddress",c),v.value=s.data}else r.setNotify({message:"郵便番号が存在しません。",type:H.error});f.value=!1};ne([O,G],()=>{var s;K.value=[],Object.keys(O).forEach(b=>{if(O[b]!==I.value[b]&&b!=="confirmPassword"){const S=l[b];K.value.push(S)}});const n=G.value?1:0;((s=B.value)==null?void 0:s.keepLastPlanContentFlg)!==n&&K.value.push(l.keepLastPlanContentFlg)},{deep:!0});const ie=Ne(async n=>{D.value=!0},({errors:n})=>{const b=Object.keys(l).map(S=>n[S]).find(Boolean)??"";r.setNotify({message:b,type:H.error})}),Se=async n=>{var c;r.clearNotify(),x.value=!0;const s={...O},b=s.password;delete s.password;const S={...s,keepLastPlanContentFlg:G.value?1:0,kaigoSoftware:Number(s.kaigoSoftware),...b&&{newPassword:b},...n&&{status:n}};await N.updateCompanyById(Number(g.value),S).finally(()=>{x.value=!1,D.value=!1}),(c=r.notify)!=null&&c.message||X("顧客情報を更新しました")},Fe=async()=>{var s;r.clearNotify(),x.value=!0,$.value=!1;const n=[Number(g.value)];if(!n.length){r.setNotify({message:"会社を削除できません。",type:H.error}),x.value=!1;return}await N.bulkDelete(n),x.value=!1,(s=r.notify)!=null&&s.message||X("顧客情報を削除しました")},$e=async()=>{var s;r.clearNotify(),x.value=!0,A.value=!1;const n=F.value===1?2:1;await N.updateStatusCompanyUser(Number(g.value),{status:n}),(s=r.notify)!=null&&s.message||X("顧客情報を更新しました"),x.value=!1},X=n=>{le.value=!0,C("/customer"),r.setNotify({message:n,type:H.success})};return(n,s)=>{const b=Re,S=Ps,c=Xe,u=Ze,z=es,J=Be,E=ts,U=ns,T=os,De=ls,Ae=is,Ie=rs,Oe=cs,Ue=ps,Ke=ms,Ge=ds,Ee=fs,Te=us,Me=hs,Le=_s;return d(),L("div",Ss,[a("div",Fs,[o(le)?Q("",!0):(d(),w(b,{key:0,class:"pl-[64px]"}))]),e(S,{isOpen:o(D),fields:o(K),onClose:s[0]||(s[0]=p=>D.value=!1),onUpdate:Se},null,8,["isOpen","fields"]),a("form",{class:"register flex flex-col gap-[25px] pl-[64px] pt-[10px] pb-[15px]",onSubmit:s[5]||(s[5]=(...p)=>o(ie)&&o(ie)(...p))},[a("div",$s,[a("div",Ds,[e(c,{label:"必須項目です",position:"left",class:"mb-[10px]"}),a("div",As,[a("div",Is,[e(c,{label:"法人名",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"companyName"})]),a("div",Os,[e(c,{label:"フリガナ",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"companyNameKana"})])]),s[21]||(s[21]=a("div",{class:"space"},null,-1)),a("div",Us,[a("div",Ks,[e(c,{label:"郵便番号",class:"w-[160px] flex"}),e(u,{"name-bind":"companyPostCode","class-form":"w-[20%]"}),e(z,{onClick:he,type:"button",variant:"cancel_btn",class:"!m-[0px] !rounded-3xl"},{default:t(()=>[o(f)?(d(),w(o(ks),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):Q("",!0),s[8]||(s[8]=k(" 郵便番号から入力 "))]),_:1})]),a("div",Gs,[e(c,{label:"会社所在地",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"companyAddress"})]),e(T,{name:"frontPicPosition"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"flex gap-5"},{default:t(()=>[e(c,{label:"代表者",class:"w-[160px] flex pt-[14px] items-baseline flex-shrink-0"}),a("div",Es,[a("div",Ts,[a("div",Ms,[s[9]||(s[9]=a("span",{class:"label w-[35px]"},"役職",-1)),e(E,null,{default:t(()=>[e(J,j({type:"text"},p,{class:{"border-red-500":P.length}}),null,16,["class"])]),_:2},1024)]),a("div",Ls,[s[10]||(s[10]=a("span",{class:"label flex w-[19%] flex-shrink-0"},"お名前",-1)),e(u,{"name-bind":"frontPicFamilyName",placeholder:"姓","class-input":"text-center"}),e(u,{"name-bind":"frontPicGivenName",placeholder:"名","class-input":"text-center"})])]),a("div",Rs,[s[12]||(s[12]=a("div",{class:"pic-position flex gap-5 items-center w-[50%]"},null,-1)),a("div",Bs,[s[11]||(s[11]=a("span",{class:"label flex w-[19%] flex-shrink-0"},"フリガナ",-1)),e(u,{"name-bind":"frontPicFamilyNameKana",placeholder:"せい","class-input":"text-center"}),e(u,{"name-bind":"frontPicGivenNameKana",placeholder:"めい","class-input":"text-center"})])])])]),_:2},1024)]),_:1}),e(T,{name:"picPosition"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"flex gap-5"},{default:t(()=>[e(c,{label:"ご担当者",class:"w-[160px] flex pt-[14px] items-baseline flex-shrink-0"}),a("div",Vs,[a("div",Hs,[a("div",js,[s[13]||(s[13]=a("span",{class:"label w-[35px]"},"役職",-1)),e(E,null,{default:t(()=>[e(J,j({type:"text"},p,{class:{"border-red-500":P.length}}),null,16,["class"])]),_:2},1024)]),a("div",qs,[s[14]||(s[14]=a("span",{class:"label flex w-[19%] flex-shrink-0"},"お名前",-1)),e(u,{"name-bind":"picFamilyName",placeholder:"姓","class-input":"text-center"}),e(u,{"name-bind":"picGivenName",placeholder:"名","class-input":"text-center"})])]),a("div",Ys,[s[16]||(s[16]=a("div",{class:"pic-position flex gap-5 items-center w-[50%]"},null,-1)),a("div",zs,[s[15]||(s[15]=a("span",{class:"label flex w-[19%] flex-shrink-0"},"フリガナ",-1)),e(u,{"name-bind":"picFamilyNameKana",placeholder:"せい","class-input":"text-center"}),e(u,{"name-bind":"picGivenNameKana",placeholder:"めい","class-input":"text-center"})])])])]),_:2},1024)]),_:1})]),s[22]||(s[22]=a("div",{class:"space"},null,-1)),a("div",Js,[a("div",Qs,[e(c,{label:"電話番号",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"phoneNumber","class-form":"w-[40%]"})]),a("div",Ws,[e(c,{label:"メールアドレス",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"email",description:"認証済みのメールアドレス"})]),a("div",Xs,[s[17]||(s[17]=a("div",{class:"w-[160px] flex-shrink-0"},[a("span",null,"パスワード")],-1)),e(T,{name:"password"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"w-[100%]"},{default:t(()=>[a("div",Zs,[e(E,null,{default:t(()=>[a("div",ea,[e(J,j({type:o(Y)?"text":"password"},p,{placeholder:"英小文字、数字を含む、半角英数字８文字以上",class:[{"border-red-500":P.length},"placeholder:text-[10px]"]}),null,16,["type","class"]),a("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:Pe,"aria-label":"Toggle password visibility"},[o(Y)?(d(),w(o(pe),{key:1,class:"h-5 w-3.5 text-black"})):(d(),w(o(ce),{key:0,class:"h-5 w-3.5 text-black"}))])])]),_:2},1024)])]),_:2},1024)]),_:1})]),a("div",sa,[e(c,{label:"介護ソフト選択",class:"w-[160px] flex-shrink-0"}),e(T,{name:"kaigoSoftware"},{default:t(({componentField:p,errors:P,meta:V})=>[e(U,{class:"w-[100%]"},{default:t(()=>[a("div",aa,[e(E,null,{default:t(()=>[e(Ue,ze(Je(p)),{default:t(()=>[e(Ae,{class:Qe({"border-red-500":P.length&&!p.modelValue})},{default:t(()=>[e(De,{placeholder:"Select an option"})]),_:2},1032,["class"]),e(Oe,null,{default:t(()=>[(d(!0),L(ae,null,te(o(ge),re=>(d(),w(Ie,{value:`${re.id}`},{default:t(()=>[k(q(re.name),1)]),_:2},1032,["value"]))),256))]),_:1})]),_:2},1040)]),_:2},1024)])]),_:2},1024)]),_:1})]),a("div",ta,[e(c,{label:"カイポケ法人ID",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"kaipokeCompanyId"})]),a("div",na,[e(c,{label:"カイポケユーザーID",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"kaipokeUserId"})]),a("div",oa,[e(c,{label:"カイポケパスワード",class:"w-[160px] flex-shrink-0"}),e(T,{name:"kaipokeUserPassword"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"w-[100%]"},{default:t(()=>[a("div",la,[e(E,null,{default:t(()=>[a("div",ia,[e(J,j({type:o(h)?"text":"password"},p,{placeholder:"英小文字、数字を含む、半角英数字８文字以上",class:[{"border-red-500":P.length},"placeholder:text-[10px]"]}),null,16,["type","class"]),a("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:Ce,"aria-label":"Toggle password visibility"},[o(h)?(d(),w(o(pe),{key:1,class:"h-5 w-3.5 text-black"})):(d(),w(o(ce),{key:0,class:"h-5 w-3.5 text-black"}))])])]),_:2},1024)])]),_:2},1024)]),_:1})]),e(T,{name:"paymentMethod"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"flex gap-5"},{default:t(()=>[e(c,{label:"決済方法",class:"w-[160px] flex-shrink-0"}),a("div",ra,[e(E,null,{default:t(()=>[e(Ge,j({class:"flex gap-5"},p),{default:t(()=>[(d(!0),L(ae,null,te("PAYMENT_METHOD_OPTIONS_LIST"in n?n.PAYMENT_METHOD_OPTIONS_LIST:o(We),V=>(d(),w(U,{class:"flex items-center space-y-0 gap-x-3"},{default:t(()=>[e(E,null,{default:t(()=>[e(Ke,{value:V.type},null,8,["value"])]),_:2},1024),a("span",null,q(V.value),1)]),_:2},1024))),256))]),_:2},1040)]),_:2},1024)])]),_:2},1024)]),_:1}),e(T,{name:"remainOldPlan"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"flex gap-5"},{default:t(()=>[s[20]||(s[20]=a("span",{class:"w-[160px] flex items-center"},"前回の計画書内容を保持する",-1)),a("div",ca,[s[18]||(s[18]=a("span",null,"OFF",-1)),e(Ee,{checked:o(G),"onUpdate:checked":s[1]||(s[1]=V=>oe(G)?G.value=V:null)},null,8,["checked"]),s[19]||(s[19]=a("span",null,"ON",-1))])]),_:1})]),_:1})])])]),a("div",pa,[a("div",ma,[e(z,{type:"button",variant:"cancel_btn",class:"flex self-center",onClick:s[2]||(s[2]=p=>o(C)("/customer"))},{default:t(()=>s[23]||(s[23]=[k(" キャンセル ")])),_:1}),a("div",{class:"delete flex self-center underline cursor-pointer",onClick:s[3]||(s[3]=()=>$.value=!0)}," 削除 ")]),a("div",da,[e(z,{type:"submit",class:"flex self-center",disabled:o(be)},{default:t(()=>s[24]||(s[24]=[k(" 変更 ")])),_:1},8,["disabled"]),o(F)!==3?(d(),w(z,{key:0,type:"button",variant:"export",class:"delete flex self-center",onClick:s[4]||(s[4]=()=>A.value=!0)},{default:t(()=>s[25]||(s[25]=[k(" 停止・開始 ")])),_:1})):Q("",!0)])])],32),e(Te,{"is-open":o($),onClose:s[6]||(s[6]=p=>$.value=!1),onUpdate:Fe},null,8,["is-open"]),e(Me,{"is-open":o(A),"active-status":o(F),onClose:s[7]||(s[7]=p=>A.value=!1),onUpdate:$e},null,8,["is-open","active-status"]),o(x)?(d(),w(Le,{key:0})):Q("",!0)])}}}),ua=ye(fa,[["__scopeId","data-v-bf0f9460"]]),_a={class:"user-list px-4"},Ea=W({__name:"[id]",setup(R){return(M,r)=>{const y=ua;return d(),L("div",_a,[r[0]||(r[0]=a("div",{class:"header flex items-center h-[40px] border-b border-b-[#e2e2e2]"},[a("span",{class:"text-base font-bold"},"顧客詳細")],-1)),e(y)])}}});export{Ea as default};
