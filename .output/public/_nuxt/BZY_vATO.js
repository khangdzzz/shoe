import{_ as G,a as O}from"./C59ExAtK.js";import{t as D,u as H,F as K,_ as Q,a as U}from"./D_poBQPb.js";import{_ as W}from"./VXga4qIW.js";import{_ as X}from"./AaSbhav4.js";import{_ as Y}from"./CBYwsDdB.js";import{o as Z,s as ss,a as ts,f as M}from"./D9cFdVGb.js";import{g as es,b as as}from"./CjlMVYQo.js";import{m as os,I as ls,u as ns,n as rs,r as p,z as is,J as ms,F as _,M as S,c as ps,a as t,b as e,p as a,w as o,o as i,q as k,v as m,x as C,d as $}from"./wsAj2bSc.js";import{u as cs}from"./D8T-4a2B.js";import{u as us}from"./Cc9Up7UI.js";import{E as B,a as N}from"./aksbdNp9.js";import{L as fs}from"./B8T39g4Y.js";import"./CF2TLoqP.js";import"./DlAUqK2U.js";const ds={class:"login-page flex flex-col items-center justify-center h-[100vh]"},_s={class:"flex flex-col min-w-[500px] bg-white px-12 py-8"},xs={class:"relative"},gs={class:"relative"},bs={class:"relative"},Bs=os({__name:"index",setup(ws){const I=ls(),L=ns(),h=rs(),E=cs(),{redirectPage:c}=us(),n=I.query.token,x=p(!1),g=p(!1),F=p(""),R=is(()=>h.notify);ms(()=>{var s;n||c("/login"),E.checkTokenValid("password",(n==null?void 0:n.toString())??"");const l=E.parseJwt((n==null?void 0:n.toString())??"");(!l||(s=R.value)!=null&&s.message)&&setTimeout(()=>{c("/login")},1e3),F.value=(l==null?void 0:l.email)??"",z("email",F.value)});const u=p(!1),f=p(!1),j=()=>{u.value=!u.value},q=()=>{f.value=!f.value},J=D(Z({email:ss(ts(_.email)).min(1,_.email),password:es(M(S.ERR001,_.password)),passwordConfirmation:as(M(S.ERR001,_.confirmPassword))}).refine(({password:l,passwordConfirmation:s})=>l===s,{message:S.ERR006,path:["passwordConfirmation"]})),{handleSubmit:A,setFieldValue:z}=H({validationSchema:J}),V=A(async l=>{var d;h.clearNotify(),g.value=!0;const{password:s}=l;await L.resetPassword(s,n),(d=R.value)!=null&&d.message||c("/confirm-email-change-password"),g.value=!1},()=>{x.value=!0});return(l,s)=>{const d=G,b=O,w=Q,y=U,v=K,P=W,T=X;return i(),ps("div",ds,[s[9]||(s[9]=t("div",{class:"logo mb-2"},[t("img",{src:Y,class:"h-[60px] w-auto"})],-1)),t("div",_s,[e(d),s[7]||(s[7]=t("h1",{class:"text-sm font-bold mb-[30px]"},"パスワード設定",-1)),s[8]||(s[8]=t("div",{class:"flex flex-col gap-2 mb-[30px]"},[t("p",{class:"text-xs"},"パスワードは英小文字、数字を含む、半角英数字８文字以上を設定してください。")],-1)),t("form",{class:"flex flex-col gap-[30px]",onSubmit:s[1]||(s[1]=(...r)=>a(V)&&a(V)(...r))},[e(v,{name:"email"},{default:o(({componentField:r})=>[e(y,{class:"relative"},{default:o(()=>[s[2]||(s[2]=t("span",{class:"font-medium"},"メールアドレス",-1)),e(w,null,{default:o(()=>[t("div",xs,[e(b,k({disabled:"",class:"bg-[#ccc]",placeholder:"メールアドレス"},r),null,16)])]),_:2},1024)]),_:2},1024)]),_:1}),e(v,{name:"password"},{default:o(({componentField:r})=>[e(y,{class:"relative"},{default:o(()=>[s[3]||(s[3]=t("span",{class:"font-medium"},"パスワード",-1)),e(w,null,{default:o(()=>[t("div",gs,[e(b,k({type:a(u)?"text":"password",placeholder:"パスワード"},r),null,16,["type"]),t("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:j,"aria-label":"Toggle password visibility"},[a(u)?(i(),m(a(N),{key:1,class:"h-5 w-3.5 text-black"})):(i(),m(a(B),{key:0,class:"h-5 w-3.5 text-black"}))])])]),_:2},1024),a(x)?(i(),m(P,{key:0,class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})):C("",!0)]),_:2},1024)]),_:1}),e(v,{name:"passwordConfirmation"},{default:o(({componentField:r})=>[e(y,{class:"relative"},{default:o(()=>[s[4]||(s[4]=t("span",{class:"font-medium"},"パスワード（確認用）",-1)),e(w,null,{default:o(()=>[t("div",bs,[e(b,k({type:a(f)?"text":"password",placeholder:"パスワード（確認用）"},r),null,16,["type"]),t("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:q,"aria-label":"Toggle password visibility"},[a(f)?(i(),m(a(N),{key:1,class:"h-5 w-3.5 text-black"})):(i(),m(a(B),{key:0,class:"h-5 w-3.5 text-black"}))])]),a(x)?(i(),m(P,{key:0,class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})):C("",!0)]),_:2},1024)]),_:2},1024)]),_:1}),e(T,{type:"submit",class:"flex self-center w-[132px]"},{default:o(()=>[a(g)?(i(),m(a(fs),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):C("",!0),s[5]||(s[5]=$(" 保存 "))]),_:1}),e(T,{class:"w-[132px]",variant:"cancel_btn",type:"button",onClick:s[0]||(s[0]=r=>a(c)("/login"))},{default:o(()=>s[6]||(s[6]=[$(" キャンセル ")])),_:1})],32)])])}}});export{Bs as default};
