import{_ as $,a as j}from"./DtoYwRtB.js";import{t as I,u as O,F as G,_ as q,a as D}from"./BOQ3TBnG.js";import{_ as K}from"./BfpUw788.js";import{_ as U}from"./CGO42oWA.js";import{_ as W}from"./DVCxLrZv.js";import{_ as X}from"./BmgsDtyP.js";import{o as Y,s as R,f as g}from"./C0PkOUq7.js";import{m as z,u as H,n as J,W as Q,s as Z,r as F,M as d,X as L,c as ss,a as t,p as a,b as e,w as o,d as c,N as es,F as v,o as _,q as C,v as y,x as ts}from"./BeFSuBZg.js";import{u as os}from"./BHvWFqEy.js";import{E as as,a as ns}from"./1YGUJuZt.js";import{L as rs}from"./Cd8bFfOI.js";import"./BiFiBInF.js";import"./DlAUqK2U.js";const ls={class:"login-page flex flex-col items-center justify-center h-[100vh]"},is={class:"min-w-[500px]"},ms={class:"relative"},cs={class:"flex flex-col gap-4 justify-center items-end mt-[20px]"},fs={class:"register"},ps={class:"forgot"},Rs=z({__name:"index",setup(us){const x=H(),b=J(),S=es(),N=Q(),{redirectPage:w}=os(),{notify:P}=Z(b),f=F(!1),p=F(!1),V=()=>{f.value=!f.value},A=I(Y({email:R(g(d.ERR001,v.email)).email({message:d.ERR004}),password:R(g(d.ERR001,v.password)).min(1,g(d.ERR001,v.password))})),{handleSubmit:B}=O({validationSchema:A}),k=B(async E=>{var r,l,i;b.clearNotify(),p.value=!0;const s=await x.login(E);if((r=P.value)!=null&&r.message){p.value=!1;return}const u=(l=s==null?void 0:s.data)==null?void 0:l.accessToken,n=(i=s==null?void 0:s.data)==null?void 0:i.refreshToken;u&&n&&(S.setLocalStorage(L.accessToken,u),S.setLocalStorage(L.refreshToken,n)),await N.initPermissions(),p.value=!1,x.currentUser&&(x.isAdmin?w("/customer"):w("/user-list"))});return(E,s)=>{const u=$,n=j,r=q,l=K,i=D,h=G,M=U,T=W;return _(),ss("div",ls,[s[8]||(s[8]=t("div",{class:"logo mb-2"},[t("img",{src:X,class:"h-[60px] w-auto"})],-1)),t("div",is,[t("form",{class:"bg-white flex flex-col px-12 py-8",onSubmit:s[0]||(s[0]=(...m)=>a(k)&&a(k)(...m))},[e(u),e(h,{name:"email"},{default:o(({componentField:m})=>[e(i,{class:"relative mb-8"},{default:o(()=>[s[1]||(s[1]=t("span",{class:"font-medium"},"メールアドレス",-1)),e(r,null,{default:o(()=>[e(n,C({type:"text",placeholder:"メールアドレス"},m),null,16)]),_:2},1024),e(l,{class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})]),_:2},1024)]),_:1}),e(h,{name:"password"},{default:o(({componentField:m})=>[e(i,{class:"relative mb-8"},{default:o(()=>[s[2]||(s[2]=t("span",{class:"font-medium"},"パスワード",-1)),e(r,null,{default:o(()=>[t("div",ms,[e(n,C({type:a(f)?"text":"password",placeholder:"パスワード"},m),null,16,["type"]),t("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:V,"aria-label":"Toggle password visibility"},[a(f)?(_(),y(a(ns),{key:1,class:"h-5 w-3.5 text-black"})):(_(),y(a(as),{key:0,class:"h-5 w-3.5 text-black"}))])])]),_:2},1024),e(l,{class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})]),_:2},1024)]),_:1}),e(M,{type:"submit",class:"flex self-center"},{default:o(()=>[a(p)?(_(),y(a(rs),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):ts("",!0),s[3]||(s[3]=c(" ログイン "))]),_:1})],32),t("div",cs,[t("div",fs,[s[5]||(s[5]=c(" 初めての方は ")),e(T,{to:"/auth-mail",class:"hover:underline"},{default:o(()=>s[4]||(s[4]=[c("「新規登録」")])),_:1})]),t("div",ps,[s[7]||(s[7]=c(" パスワードを忘れた場合は ")),e(T,{to:"/forgot-password",class:"hover:underline"},{default:o(()=>s[6]||(s[6]=[c("「こちら」")])),_:1})])])])])}}});export{Rs as default};
