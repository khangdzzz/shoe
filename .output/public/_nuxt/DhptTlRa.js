import{_ as Re,a as Be}from"./CuNwIUpc.js";import{_ as me,a as de,b as fe,c as ue,d as _e,e as xe,f as ve}from"./f10XMYLh.js";import{m as W,r as _,g as ne,o as d,v as w,w as t,b as e,d as k,a,c as L,D as ae,E as te,t as q,p as o,H as oe,y as Ve,n as He,I as je,z as Z,J as qe,F as l,M as Ye,T as H,x as Q,q as j,A as ze,B as Je,C as Qe,G as We}from"./DIuhiDEr.js";import{_ as Xe}from"./-f0uhYuv.js";import{_ as Ze}from"./eJ5gTXcP.js";import{_ as es}from"./Czj0eQEe.js";import{t as ss,u as as,_ as ts,a as ns,F as os}from"./CJN3o0Fw.js";import{_ as ls,a as is,b as rs,c as cs,d as ps}from"./DGrpSx3m.js";import{_ as ms,a as ds}from"./B_3W6ZBB.js";import{_ as fs}from"./A-K9Vv9W.js";import{_ as us}from"./CRig0oBy.js";import{_ as ye}from"./DlAUqK2U.js";import{_ as _s}from"./D-CSR3Ko.js";import{o as xs,l as vs,s as ee,f as ys,a as se}from"./D1QClQyv.js";import{v as m,g as gs}from"./ek3HdorF.js";import{u as bs}from"./DmmG5LWh.js";import{u as ks}from"./CXOarpWc.js";import{L as ws}from"./DA60YKYR.js";import{E as ce,a as pe}from"./DPQCxREg.js";import"./CfT_0_Dv.js";import"./Bw_wrPD3.js";const Ns={class:"border border-gray-300 p-4 min-h-[150px]"},Ps={class:"flex flex-col gap-2"},Cs=W({__name:"confirm-update-customer",props:{isOpen:{type:Boolean},fields:{}},emits:["close","update"],setup(R,{emit:M}){const r=R,g=_(r.isOpen);ne(()=>r.isOpen,b=>{g.value=b});const N=M,C=()=>{N("close")},y=()=>{N("update")};return(b,f)=>{const x=me,$=de,D=fe,A=ue,I=_e,O=xe,K=ve;return d(),w(K,{open:o(g),"onUpdate:open":f[0]||(f[0]=h=>oe(g)?g.value=h:null)},{default:t(()=>[e(O,null,{default:t(()=>[e($,{class:"flex flex-col gap-4"},{default:t(()=>[e(x,{class:"text-sm text-center"},{default:t(()=>f[1]||(f[1]=[k("変更の確認")])),_:1}),e(x,{class:"text-sm font-normal"},{default:t(()=>f[2]||(f[2]=[k("以下の内容を変更します。よろしいですか？")])),_:1})]),_:1}),a("div",Ns,[a("ul",Ps,[(d(!0),L(ae,null,te(b.fields,h=>(d(),L("li",{key:h},q(h),1))),128))])]),e(I,{class:"flex !flex-col gap-4"},{default:t(()=>[e(D,{class:"flex self-center min-w-[120px]",onClick:y},{default:t(()=>f[3]||(f[3]=[k("変更")])),_:1}),e(A,{class:"flex self-center border border-gray-300 min-w-[120px]",onClick:C},{default:t(()=>f[4]||(f[4]=[k("キャンセル")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}}),hs=W({__name:"execution-confirm",props:{isOpen:{type:Boolean},activeStatus:{}},emits:["close","update"],setup(R,{emit:M}){const r=R,g=_(r.isOpen);ne(()=>r.isOpen,C=>{g.value=C});const N=M;return(C,y)=>{const b=me,f=de,x=fe,$=ue,D=_e,A=xe,I=ve;return d(),w(I,{open:o(g),"onUpdate:open":y[2]||(y[2]=O=>oe(g)?g.value=O:null),class:"delete-modal"},{default:t(()=>[e(A,null,{default:t(()=>[e(f,{class:"flex flex-col gap-6 items-center mb-4"},{default:t(()=>[e(b,{class:"text-sm"},{default:t(()=>y[3]||(y[3]=[k("実行の確認")])),_:1}),e(b,{class:"text-sm font-normal"},{default:t(()=>[k(q(C.activeStatus===1?"顧客の利用を停止します。よろしいですか？":"顧客の利用を再開します。よろしいですか？"),1)]),_:1})]),_:1}),e(D,{class:"flex !flex-col gap-5"},{default:t(()=>[e(x,{class:"flex self-center min-w-[120px]",onClick:y[0]||(y[0]=O=>N("update"))},{default:t(()=>[k(q(C.activeStatus===1?"停止":"開始"),1)]),_:1}),e($,{class:"flex self-center border border-gray-300 min-w-[120px]",onClick:y[1]||(y[1]=O=>N("close"))},{default:t(()=>y[4]||(y[4]=[k("キャンセル")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}}),Ss=ye(hs,[["__scopeId","data-v-98fde63d"]]),Fs={class:"login-page flex flex-col !h-[100vh] overflow-hidden relative"},$s={class:"flex justify-between mt-[15px]"},Ds={class:"form overflow-y-auto scroll"},As={class:"flex flex-col w-[900px] gap-[25px] pb-[20px]"},Is={class:"company flex flex-col gap-5"},Os={class:"flex gap-5 items-center"},Us={class:"flex gap-5 items-center"},Ks={class:"information flex flex-col gap-5"},Gs={class:"flex gap-5 items-center"},Ts={class:"flex gap-5 items-center"},Es={class:"flex flex-col gap-[15px] w-[82%]"},Ms={class:"flex gap-5 items-center !m-[0px]"},Ls={class:"pic-position flex gap-5 items-center w-[50%]"},Rs={class:"pic-name flex items-center gap-5 w-[50%]"},Bs={class:"flex gap-5 items-center !m-[0px]"},Vs={class:"pic-name flex items-center gap-5 w-[50%]"},Hs={class:"flex flex-col gap-[15px] w-[82%]"},js={class:"flex gap-5 items-center !m-[0px]"},qs={class:"pic-position flex gap-5 items-center w-[50%]"},Ys={class:"pic-name flex items-center gap-5 w-[50%]"},zs={class:"flex gap-5 items-center !m-[0px]"},Js={class:"pic-name flex items-center gap-5 w-[50%]"},Qs={class:"contact flex flex-col gap-6"},Ws={class:"flex gap-5 items-center"},Xs={class:"flex gap-5 items-center -mb-[12.5px]"},Zs={class:"flex gap-5 items-center"},ea={class:"relative !m-[0px]"},sa={class:"relative"},aa={class:"flex gap-5 items-center"},ta={class:"!m-[0px]"},na={class:"flex gap-5 items-center"},oa={class:"flex gap-5 items-center"},la={class:"flex gap-5 items-center"},ia={class:"relative !m-[0px]"},ra={class:"relative"},ca={class:"relative w-[82%] !m-[0px]"},pa={class:"relative w-[82%] !m-[0px] flex gap-2 items-center"},ma={class:"flex max-w-[900px] justify-between py-[20px]"},da={class:"flex gap-5"},fa={class:"flex gap-5"},ua=W({__name:"index",setup(R){const M=Ve(),r=He(),g=je(),N=bs(),{redirectPage:C}=ks(),y=_(),b=_(""),f=_(!1),x=_(!1),$=_(0),D=_(!1),A=_(!1),I=_(!1),O=_({}),K=_([]),h=_(!1),Y=_(!1),G=_(!1),ge=Z(()=>{var n;return(n=M.masterData)==null?void 0:n.kaigoSoftwares}),B=Z(()=>N.companyUser),be=Z(()=>K.value.length==0),le=_(!1);qe(async()=>{if(x.value=!0,b.value=g.params.id,!b)return C("/customer");await N.getCompanyById(Number(b.value)),B.value&&(ke(),$.value=B.value.status),x.value=!1});const ke=()=>{if(B.value){const n=B.value;i("companyName",n.companyName),i("companyNameKana",n.companyNameKana),i("companyPostCode",n.companyPostCode),i("companyAddress",n.companyAddress),i("phoneNumber",n.phoneNumber),i("picFamilyName",n.picFamilyName),i("picFamilyNameKana",n.picFamilyNameKana),i("picGivenName",n.picGivenName),i("picGivenNameKana",n.picGivenNameKana),i("picPosition",n.picPosition),i("frontPicFamilyName",n.frontPicFamilyName),i("frontPicFamilyNameKana",n.frontPicFamilyNameKana),i("frontPicGivenName",n.frontPicGivenName),i("frontPicGivenNameKana",n.frontPicGivenNameKana),i("frontPicPosition",n.frontPicPosition),i("kaipokeUserId",n.kaipokeUserId),i("kaipokeUserPassword",n.kaipokeUserPassword),i("kaipokeCompanyId",n.kaipokeCompanyId),i("paymentMethod",n.paymentMethod),i("kaigoSoftware",n.kaigoSoftware.toString()),i("email",n.email),G.value=n.keepLastPlanContentFlg==1,O.value={...S}}},we=ss(xs({companyName:m(l.companyName,250),companyNameKana:m(l.companyNameKana,250,!0),companyPostCode:m(l.companyPostCode,10),companyAddress:m(l.companyAddress,250),frontPicPosition:m(l.frontPicPosition,100),frontPicFamilyName:m(l.frontPicFamilyName,100),frontPicGivenName:m(l.frontPicGivenName,100),frontPicFamilyNameKana:m(l.frontPicFamilyNameKana,100,!0),frontPicGivenNameKana:m(l.frontPicGivenNameKana,100,!0),picPosition:m(l.picPosition,100),picFamilyName:m(l.picFamilyName,100),picGivenName:m(l.picGivenName,100),picFamilyNameKana:m(l.picFamilyNameKana,100,!0),picGivenNameKana:m(l.picGivenNameKana,100,!0),phoneNumber:m(l.phoneNumber,20),email:m(l.email,250),password:gs().optional().or(vs("")),kaigoSoftware:ee(ys(Ye.ERR002,l.kaigoSoftware)).min(1,se(l.kaigoSoftware)),kaipokeCompanyId:m(l.kaipokeCompanyId,100),kaipokeUserId:m(l.kaipokeUserId,100),kaipokeUserPassword:ee(se(l.kaipokeUserPassword)).min(1,se(l.kaipokeUserPassword)),paymentMethod:ee().nullable().optional()})),{handleSubmit:Ne,values:S,setFieldValue:i}=as({validationSchema:we}),Pe=()=>{Y.value=!Y.value},Ce=()=>{h.value=!h.value},he=async()=>{const n=S==null?void 0:S.companyPostCode;if(!n){r.setNotify({message:"郵便番号が存在しません。",type:H.error});return}f.value=!0;const s=await r.searchPostalCode(n);if(s!=null&&s.data){const{prefecture:v,city:F}=s.data,c=`${v} ${F}`;i("companyAddress",c),y.value=s.data}else r.setNotify({message:"郵便番号が存在しません。",type:H.error});f.value=!1};ne([S,G],()=>{var s;K.value=[],Object.keys(S).forEach(v=>{if(S[v]!==O.value[v]&&v!=="confirmPassword"){if(v==="password"&&S[v]==="")return;const F=l[v];K.value.push(F)}});const n=G.value?1:0;((s=B.value)==null?void 0:s.keepLastPlanContentFlg)!==n&&K.value.push(l.keepLastPlanContentFlg)},{deep:!0});const ie=Ne(async n=>{A.value=!0},({errors:n})=>{const v=Object.keys(l).map(F=>n[F]).find(Boolean)??"";r.setNotify({message:v,type:H.error})}),Se=async n=>{var c;r.clearNotify(),x.value=!0;const s={...S},v=s.password;delete s.password;const F={...s,keepLastPlanContentFlg:G.value?1:0,kaigoSoftware:Number(s.kaigoSoftware),...v&&{newPassword:v},...n&&{status:n}};await N.updateCompanyById(Number(b.value),F).finally(()=>{x.value=!1,A.value=!1}),(c=r.notify)!=null&&c.message||X("顧客情報を更新しました")},Fe=async()=>{var s;r.clearNotify(),x.value=!0,D.value=!1;const n=[Number(b.value)];if(!n.length){r.setNotify({message:"会社を削除できません。",type:H.error}),x.value=!1;return}await N.bulkDelete(n),x.value=!1,(s=r.notify)!=null&&s.message||X("顧客情報を削除しました")},$e=async()=>{var s;r.clearNotify(),x.value=!0,I.value=!1;const n=$.value===1?2:1;await N.updateStatusCompanyUser(Number(b.value),{status:n}),(s=r.notify)!=null&&s.message||X("顧客情報を更新しました"),x.value=!1},X=n=>{le.value=!0,C("/customer"),r.setNotify({message:n,type:H.success})};return(n,s)=>{const v=Re,F=Cs,c=Xe,u=Ze,z=es,J=Be,T=ts,U=ns,E=os,De=ls,Ae=is,Ie=rs,Oe=cs,Ue=ps,Ke=ms,Ge=ds,Te=fs,Ee=us,Me=Ss,Le=_s;return d(),L("div",Fs,[a("div",$s,[o(le)?Q("",!0):(d(),w(v,{key:0,class:"pl-[64px]"}))]),e(F,{isOpen:o(A),fields:o(K),onClose:s[0]||(s[0]=p=>A.value=!1),onUpdate:Se},null,8,["isOpen","fields"]),a("form",{class:"register flex flex-col gap-[25px] pl-[64px] pt-[10px] pb-[15px]",onSubmit:s[5]||(s[5]=(...p)=>o(ie)&&o(ie)(...p))},[a("div",Ds,[a("div",As,[e(c,{label:"必須項目です",position:"left",class:"mb-[10px]"}),a("div",Is,[a("div",Os,[e(c,{label:"法人名",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"companyName"})]),a("div",Us,[e(c,{label:"フリガナ",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"companyNameKana"})])]),s[21]||(s[21]=a("div",{class:"space"},null,-1)),a("div",Ks,[a("div",Gs,[e(c,{label:"郵便番号",class:"w-[160px] flex"}),e(u,{"name-bind":"companyPostCode","class-form":"w-[20%]"}),e(z,{onClick:he,type:"button",variant:"cancel_btn",class:"!m-[0px] !rounded-3xl"},{default:t(()=>[o(f)?(d(),w(o(ws),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):Q("",!0),s[8]||(s[8]=k(" 郵便番号から入力 "))]),_:1})]),a("div",Ts,[e(c,{label:"会社所在地",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"companyAddress"})]),e(E,{name:"frontPicPosition"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"flex gap-5"},{default:t(()=>[e(c,{label:"代表者",class:"w-[160px] flex pt-[14px] items-baseline flex-shrink-0"}),a("div",Es,[a("div",Ms,[a("div",Ls,[s[9]||(s[9]=a("span",{class:"label w-[35px]"},"役職",-1)),e(T,null,{default:t(()=>[e(J,j({type:"text"},p,{class:{"border-red-500":P.length}}),null,16,["class"])]),_:2},1024)]),a("div",Rs,[s[10]||(s[10]=a("span",{class:"label flex w-[19%] flex-shrink-0"},"お名前",-1)),e(u,{"name-bind":"frontPicFamilyName",placeholder:"姓","class-input":"text-center"}),e(u,{"name-bind":"frontPicGivenName",placeholder:"名","class-input":"text-center"})])]),a("div",Bs,[s[12]||(s[12]=a("div",{class:"pic-position flex gap-5 items-center w-[50%]"},null,-1)),a("div",Vs,[s[11]||(s[11]=a("span",{class:"label flex w-[19%] flex-shrink-0"},"フリガナ",-1)),e(u,{"name-bind":"frontPicFamilyNameKana",placeholder:"せい","class-input":"text-center"}),e(u,{"name-bind":"frontPicGivenNameKana",placeholder:"めい","class-input":"text-center"})])])])]),_:2},1024)]),_:1}),e(E,{name:"picPosition"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"flex gap-5"},{default:t(()=>[e(c,{label:"ご担当者",class:"w-[160px] flex pt-[14px] items-baseline flex-shrink-0"}),a("div",Hs,[a("div",js,[a("div",qs,[s[13]||(s[13]=a("span",{class:"label w-[35px]"},"役職",-1)),e(T,null,{default:t(()=>[e(J,j({type:"text"},p,{class:{"border-red-500":P.length}}),null,16,["class"])]),_:2},1024)]),a("div",Ys,[s[14]||(s[14]=a("span",{class:"label flex w-[19%] flex-shrink-0"},"お名前",-1)),e(u,{"name-bind":"picFamilyName",placeholder:"姓","class-input":"text-center"}),e(u,{"name-bind":"picGivenName",placeholder:"名","class-input":"text-center"})])]),a("div",zs,[s[16]||(s[16]=a("div",{class:"pic-position flex gap-5 items-center w-[50%]"},null,-1)),a("div",Js,[s[15]||(s[15]=a("span",{class:"label flex w-[19%] flex-shrink-0"},"フリガナ",-1)),e(u,{"name-bind":"picFamilyNameKana",placeholder:"せい","class-input":"text-center"}),e(u,{"name-bind":"picGivenNameKana",placeholder:"めい","class-input":"text-center"})])])])]),_:2},1024)]),_:1})]),s[22]||(s[22]=a("div",{class:"space"},null,-1)),a("div",Qs,[a("div",Ws,[e(c,{label:"電話番号",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"phoneNumber","class-form":"w-[40%]"})]),a("div",Xs,[e(c,{label:"メールアドレス",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"email",description:"認証済みのメールアドレス"})]),a("div",Zs,[s[17]||(s[17]=a("div",{class:"w-[160px] flex-shrink-0"},[a("span",null,"パスワード")],-1)),e(E,{name:"password"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"w-[100%]"},{default:t(()=>[a("div",ea,[e(T,null,{default:t(()=>[a("div",sa,[e(J,j({type:o(Y)?"text":"password"},p,{placeholder:"英小文字、数字を含む、半角英数字８文字以上",class:[{"border-red-500":P.length},"placeholder:text-[10px]"]}),null,16,["type","class"]),a("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:Pe,"aria-label":"Toggle password visibility"},[o(Y)?(d(),w(o(pe),{key:1,class:"h-5 w-3.5 text-black"})):(d(),w(o(ce),{key:0,class:"h-5 w-3.5 text-black"}))])])]),_:2},1024)])]),_:2},1024)]),_:1})]),a("div",aa,[e(c,{label:"介護ソフト選択",class:"w-[160px] flex-shrink-0"}),e(E,{name:"kaigoSoftware"},{default:t(({componentField:p,errors:P,meta:V})=>[e(U,{class:"w-[100%]"},{default:t(()=>[a("div",ta,[e(T,null,{default:t(()=>[e(Ue,ze(Je(p)),{default:t(()=>[e(Ae,{class:Qe({"border-red-500":P.length&&!p.modelValue})},{default:t(()=>[e(De,{placeholder:"Select an option"})]),_:2},1032,["class"]),e(Oe,null,{default:t(()=>[(d(!0),L(ae,null,te(o(ge),re=>(d(),w(Ie,{value:`${re.id}`},{default:t(()=>[k(q(re.name),1)]),_:2},1032,["value"]))),256))]),_:1})]),_:2},1040)]),_:2},1024)])]),_:2},1024)]),_:1})]),a("div",na,[e(c,{label:"カイポケ法人ID",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"kaipokeCompanyId"})]),a("div",oa,[e(c,{label:"カイポケユーザーID",class:"w-[160px] flex-shrink-0"}),e(u,{"name-bind":"kaipokeUserId"})]),a("div",la,[e(c,{label:"カイポケパスワード",class:"w-[160px] flex-shrink-0"}),e(E,{name:"kaipokeUserPassword"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"w-[100%]"},{default:t(()=>[a("div",ia,[e(T,null,{default:t(()=>[a("div",ra,[e(J,j({type:o(h)?"text":"password"},p,{placeholder:"英小文字、数字を含む、半角英数字８文字以上",class:[{"border-red-500":P.length},"placeholder:text-[10px]"]}),null,16,["type","class"]),a("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:Ce,"aria-label":"Toggle password visibility"},[o(h)?(d(),w(o(pe),{key:1,class:"h-5 w-3.5 text-black"})):(d(),w(o(ce),{key:0,class:"h-5 w-3.5 text-black"}))])])]),_:2},1024)])]),_:2},1024)]),_:1})]),e(E,{name:"paymentMethod"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"flex gap-5"},{default:t(()=>[e(c,{label:"決済方法",class:"w-[160px] flex-shrink-0"}),a("div",ca,[e(T,null,{default:t(()=>[e(Ge,j({class:"flex gap-5"},p),{default:t(()=>[(d(!0),L(ae,null,te("PAYMENT_METHOD_OPTIONS_LIST"in n?n.PAYMENT_METHOD_OPTIONS_LIST:o(We),V=>(d(),w(U,{class:"flex items-center space-y-0 gap-x-3"},{default:t(()=>[e(T,null,{default:t(()=>[e(Ke,{value:V.type},null,8,["value"])]),_:2},1024),a("span",null,q(V.value),1)]),_:2},1024))),256))]),_:2},1040)]),_:2},1024)])]),_:2},1024)]),_:1}),e(E,{name:"remainOldPlan"},{default:t(({componentField:p,errors:P})=>[e(U,{class:"flex gap-5"},{default:t(()=>[s[20]||(s[20]=a("span",{class:"w-[160px] flex items-center"},"前回の計画書内容を保持する",-1)),a("div",pa,[s[18]||(s[18]=a("span",null,"OFF",-1)),e(Te,{checked:o(G),"onUpdate:checked":s[1]||(s[1]=V=>oe(G)?G.value=V:null)},null,8,["checked"]),s[19]||(s[19]=a("span",null,"ON",-1))])]),_:1})]),_:1})])])]),a("div",ma,[a("div",da,[e(z,{type:"button",variant:"cancel_btn",class:"flex self-center",onClick:s[2]||(s[2]=p=>o(C)("/customer"))},{default:t(()=>s[23]||(s[23]=[k(" キャンセル ")])),_:1}),a("div",{class:"delete flex self-center underline cursor-pointer",onClick:s[3]||(s[3]=()=>D.value=!0)}," 削除 ")]),a("div",fa,[e(z,{type:"submit",class:"flex self-center",disabled:o(be)},{default:t(()=>s[24]||(s[24]=[k(" 変更 ")])),_:1},8,["disabled"]),o($)!==3?(d(),w(z,{key:0,type:"button",variant:"export",class:"delete flex self-center",onClick:s[4]||(s[4]=()=>I.value=!0)},{default:t(()=>s[25]||(s[25]=[k(" 停止・開始 ")])),_:1})):Q("",!0)])])],32),e(Ee,{"is-open":o(D),onClose:s[6]||(s[6]=p=>D.value=!1),onUpdate:Fe},null,8,["is-open"]),e(Me,{"is-open":o(I),"active-status":o($),onClose:s[7]||(s[7]=p=>I.value=!1),onUpdate:$e},null,8,["is-open","active-status"]),o(x)?(d(),w(Le,{key:0})):Q("",!0)])}}}),_a=ye(ua,[["__scopeId","data-v-76e9fd01"]]),xa={class:"user-list px-4"},Ea=W({__name:"[id]",setup(R){return(M,r)=>{const g=_a;return d(),L("div",xa,[r[0]||(r[0]=a("div",{class:"header flex items-center h-[40px] border-b border-b-[#e2e2e2]"},[a("span",{class:"text-base font-bold"},"顧客詳細")],-1)),e(g)])}}});export{Ea as default};
