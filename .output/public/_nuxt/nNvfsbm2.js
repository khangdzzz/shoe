import{t as G,m as J,f as V,u as z,F as D,_ as H,a as K,c as Q,b as U}from"./Cf2Er9Yy.js";import{_ as W}from"./B8C-_1IN.js";import{_ as X}from"./B1-tIYX1.js";import{o as Y,s as Z}from"./C7MCtxAn.js";import{g as P}from"./CeBub2V_.js";import{m as ss,z as es,u as ts,n as as,r as d,A as os,I as ls,F as x,M as v,c as ns,a as t,b as e,p as a,w as o,o as r,q as S,v as m,x as is,d as T}from"./DrFhWPsP.js";import{u as rs}from"./ZcBf-8CS.js";import{u as ms}from"./BWWfaIti.js";import{E as $,a as M}from"./DcKuieJy.js";import{L as ps}from"./Qu6DD8fX.js";import"./Czcjm8Ww.js";const cs={class:"login-page flex flex-col items-center justify-center h-[100vh]"},fs={class:"flex flex-col min-w-[500px] bg-white px-12 py-8"},us={class:"relative"},ds={class:"relative"},xs={class:"relative"},Rs=ss({__name:"index",setup(_s){const B=es(),L=ts(),I=as(),k=rs(),{redirectPage:p}=ms(),n=B.query.token,_=d(!1),C=d(""),h=os(()=>I.notify);ls(()=>{var s;n||p("/login"),k.checkTokenValid("password",(n==null?void 0:n.toString())??"");const l=k.parseJwt((n==null?void 0:n.toString())??"");(!l||(s=h.value)!=null&&s.message)&&setTimeout(()=>{p("/login")},1e3),C.value=(l==null?void 0:l.email)??"",O("email",C.value)});const c=d(!1),f=d(!1),N=()=>{c.value=!c.value},j=()=>{f.value=!f.value},q=G(Y({email:Z(J(x.email)).min(1,x.email),password:P(V(v.ERR001,x.password)),passwordConfirmation:P(V(v.ERR001,x.confirmPassword))}).refine(({password:l,passwordConfirmation:s})=>l===s,{message:v.ERR006,path:["passwordConfirmation"]})),{handleSubmit:A,setFieldValue:O}=z({validationSchema:q}),E=A(async l=>{var u;_.value=!0;const{password:s}=l;await L.resetPassword(s,n),(u=h.value)!=null&&u.message||p("/confirm-email-change-password"),_.value=!1});return(l,s)=>{const u=H,g=W,b=K,w=Q,y=D,F=U,R=X;return r(),ns("div",cs,[s[9]||(s[9]=t("div",{class:"logo"},"LOGO",-1)),t("div",fs,[e(u),s[7]||(s[7]=t("h1",{class:"text-sm font-bold mb-[30px]"},"パスワード設定",-1)),s[8]||(s[8]=t("div",{class:"flex flex-col gap-2 mb-[30px]"},[t("p",{class:"text-xs"},"パスワードは英小文字、数字を含む、半角英数字８文字以上を設定してください。")],-1)),t("form",{class:"flex flex-col gap-[30px]",onSubmit:s[1]||(s[1]=(...i)=>a(E)&&a(E)(...i))},[e(y,{name:"email"},{default:o(({componentField:i})=>[e(w,{class:"relative"},{default:o(()=>[s[2]||(s[2]=t("span",{class:"font-medium"},"メールアドレス",-1)),e(b,null,{default:o(()=>[t("div",us,[e(g,S({disabled:"",class:"bg-[#ccc]",placeholder:"メールアドレス"},i),null,16)])]),_:2},1024)]),_:2},1024)]),_:1}),e(y,{name:"password"},{default:o(({componentField:i})=>[e(w,{class:"relative"},{default:o(()=>[s[3]||(s[3]=t("span",{class:"font-medium"},"パスワード",-1)),e(b,null,{default:o(()=>[t("div",ds,[e(g,S({type:a(c)?"text":"password",placeholder:"パスワード"},i),null,16,["type"]),t("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:N,"aria-label":"Toggle password visibility"},[a(c)?(r(),m(a(M),{key:1,class:"h-5 w-3.5 text-black"})):(r(),m(a($),{key:0,class:"h-5 w-3.5 text-black"}))])])]),_:2},1024),e(F,{class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})]),_:2},1024)]),_:1}),e(y,{name:"passwordConfirmation"},{default:o(({componentField:i})=>[e(w,{class:"relative"},{default:o(()=>[s[4]||(s[4]=t("span",{class:"font-medium"},"パスワード（確認用）",-1)),e(b,null,{default:o(()=>[t("div",xs,[e(g,S({type:a(f)?"text":"password",placeholder:"パスワード（確認用）"},i),null,16,["type"]),t("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:j,"aria-label":"Toggle password visibility"},[a(f)?(r(),m(a(M),{key:1,class:"h-5 w-3.5 text-black"})):(r(),m(a($),{key:0,class:"h-5 w-3.5 text-black"}))])]),e(F,{class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})]),_:2},1024)]),_:2},1024)]),_:1}),e(R,{type:"submit",class:"flex self-center w-[132px]"},{default:o(()=>[a(_)?(r(),m(a(ps),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):is("",!0),s[5]||(s[5]=T(" 保存 "))]),_:1}),e(R,{class:"w-[132px]",variant:"cancel_btn",type:"button",onClick:s[0]||(s[0]=i=>a(p)("/login"))},{default:o(()=>s[6]||(s[6]=[T(" キャンセル ")])),_:1})],32)])])}}});export{Rs as default};
