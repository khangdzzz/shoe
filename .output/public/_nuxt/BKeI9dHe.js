import{_ as A}from"./C0YLyy08.js";import{_ as G}from"./DMEcRIJs.js";import{t as z,u as D,F as H,_ as K,a as Q}from"./DMto6h5J.js";import{_ as U}from"./D0bW1xR5.js";import{_ as W}from"./Xkv3Mony.js";import{o as X,s as Y,a as Z,f as P}from"./Cy6_A6yH.js";import{g as T}from"./LqRc_VJI.js";import{m as ss,I as ts,u as es,n as as,r as d,z as os,J as ls,F as _,M as v,c as ns,a as e,b as t,p as a,w as o,o as i,q as S,v as m,x as rs,d as M}from"./DW_7VQbc.js";import{u as is}from"./DvVjlwNE.js";import{u as ms}from"./Qktkm7n5.js";import{E as $,a as B}from"./D9nitXii.js";import{L as ps}from"./B4yDaHxh.js";import"./DlAUqK2U.js";import"./Woc8Mufa.js";const cs={class:"login-page flex flex-col items-center justify-center h-[100vh]"},fs={class:"flex flex-col min-w-[500px] bg-white px-12 py-8"},us={class:"relative"},ds={class:"relative"},_s={class:"relative"},Ts=ss({__name:"index",setup(xs){const L=ts(),N=es(),k=as(),C=is(),{redirectPage:p}=ms(),n=L.query.token,x=d(!1),h=d(""),E=os(()=>k.notify);ls(()=>{var s;n||p("/login"),C.checkTokenValid("password",(n==null?void 0:n.toString())??"");const l=C.parseJwt((n==null?void 0:n.toString())??"");(!l||(s=E.value)!=null&&s.message)&&setTimeout(()=>{p("/login")},1e3),h.value=(l==null?void 0:l.email)??"",O("email",h.value)});const c=d(!1),f=d(!1),I=()=>{c.value=!c.value},j=()=>{f.value=!f.value},q=z(X({email:Y(Z(_.email)).min(1,_.email),password:T(P(v.ERR001,_.password)),passwordConfirmation:T(P(v.ERR001,_.confirmPassword))}).refine(({password:l,passwordConfirmation:s})=>l===s,{message:v.ERR006,path:["passwordConfirmation"]})),{handleSubmit:J,setFieldValue:O}=D({validationSchema:q}),F=J(async l=>{var u;k.clearNotify(),x.value=!0;const{password:s}=l;await N.resetPassword(s,n),(u=E.value)!=null&&u.message||p("/confirm-email-change-password"),x.value=!1});return(l,s)=>{const u=A,g=G,w=K,b=Q,y=H,R=U,V=W;return i(),ns("div",cs,[s[9]||(s[9]=e("div",{class:"logo"},"LOGO",-1)),e("div",fs,[t(u),s[7]||(s[7]=e("h1",{class:"text-sm font-bold mb-[30px]"},"パスワード設定",-1)),s[8]||(s[8]=e("div",{class:"flex flex-col gap-2 mb-[30px]"},[e("p",{class:"text-xs"},"パスワードは英小文字、数字を含む、半角英数字８文字以上を設定してください。")],-1)),e("form",{class:"flex flex-col gap-[30px]",onSubmit:s[1]||(s[1]=(...r)=>a(F)&&a(F)(...r))},[t(y,{name:"email"},{default:o(({componentField:r})=>[t(b,{class:"relative"},{default:o(()=>[s[2]||(s[2]=e("span",{class:"font-medium"},"メールアドレス",-1)),t(w,null,{default:o(()=>[e("div",us,[t(g,S({disabled:"",class:"bg-[#ccc]",placeholder:"メールアドレス"},r),null,16)])]),_:2},1024)]),_:2},1024)]),_:1}),t(y,{name:"password"},{default:o(({componentField:r})=>[t(b,{class:"relative"},{default:o(()=>[s[3]||(s[3]=e("span",{class:"font-medium"},"パスワード",-1)),t(w,null,{default:o(()=>[e("div",ds,[t(g,S({type:a(c)?"text":"password",placeholder:"パスワード"},r),null,16,["type"]),e("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:I,"aria-label":"Toggle password visibility"},[a(c)?(i(),m(a(B),{key:1,class:"h-5 w-3.5 text-black"})):(i(),m(a($),{key:0,class:"h-5 w-3.5 text-black"}))])])]),_:2},1024),t(R,{class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})]),_:2},1024)]),_:1}),t(y,{name:"passwordConfirmation"},{default:o(({componentField:r})=>[t(b,{class:"relative"},{default:o(()=>[s[4]||(s[4]=e("span",{class:"font-medium"},"パスワード（確認用）",-1)),t(w,null,{default:o(()=>[e("div",_s,[t(g,S({type:a(f)?"text":"password",placeholder:"パスワード（確認用）"},r),null,16,["type"]),e("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:j,"aria-label":"Toggle password visibility"},[a(f)?(i(),m(a(B),{key:1,class:"h-5 w-3.5 text-black"})):(i(),m(a($),{key:0,class:"h-5 w-3.5 text-black"}))])]),t(R,{class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})]),_:2},1024)]),_:2},1024)]),_:1}),t(V,{type:"submit",class:"flex self-center w-[132px]"},{default:o(()=>[a(x)?(i(),m(a(ps),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):rs("",!0),s[5]||(s[5]=M(" 保存 "))]),_:1}),t(V,{class:"w-[132px]",variant:"cancel_btn",type:"button",onClick:s[0]||(s[0]=r=>a(p)("/login"))},{default:o(()=>s[6]||(s[6]=[M(" キャンセル ")])),_:1})],32)])])}}});export{Ts as default};
