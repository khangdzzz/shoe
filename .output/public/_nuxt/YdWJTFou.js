import{t as O,o as P,s as T,f as g,u as j,F as G,L as I,_ as q,a as z,b as D,c as K}from"./BSo77fPl.js";import{_ as U}from"./DWuNjeID.js";import{_ as Y}from"./C5c0A0Ah.js";import{_ as H}from"./_W8HATZz.js";import{m as J,u as Q,n as W,z as X,p as Z,s as ss,r as L,M as p,L as R,c as es,a as t,q as a,b as e,w as o,d as c,A as ts,F as v,o as d,v as F,x as y,y as os}from"./y0evPSAL.js";import{E as as,a as ns}from"./BP5fTaPr.js";import"./aAcqrNDs.js";import"./Bgy5XPsR.js";const rs={class:"login-page flex flex-col items-center justify-center h-[100vh]"},ls={class:"min-w-[500px]"},is={class:"relative"},ms={class:"flex flex-col gap-4 justify-center items-end mt-[20px]"},cs={class:"register"},us={class:"forgot"},Ss=J({__name:"index",setup(fs){const _=Q(),C=W(),b=ts(),A=X(),S=Z(),{errors:V}=ss(C),u=L(!1),x=L(!1),$=()=>{u.value=!u.value},B=O(P({email:T(g(p.ERR001,v.email)).email({message:p.ERR004}),password:T(g(p.ERR001,v.password)).min(1,g(p.ERR001,v.password))})),{handleSubmit:M}=j({validationSchema:B}),w=M(async k=>{var r,l,i;x.value=!0;const s=await _.login(k);if((r=V.value)!=null&&r.message)return;const f=(l=s==null?void 0:s.data)==null?void 0:l.accessToken,n=(i=s==null?void 0:s.data)==null?void 0:i.refreshToken;f&&n&&(b.setLocalStorage(R.accessToken,f),b.setLocalStorage(R.refreshToken,n)),await A.initPermissions(),x.value=!1,_.currentUser&&(_.isAdmin?S.push("/customer"):S.push("/user-list"))});return(k,s)=>{const f=q,n=U,r=z,l=D,i=K,h=G,N=Y,E=H;return d(),es("div",rs,[s[8]||(s[8]=t("div",{class:"logo"},"LOGO",-1)),t("div",ls,[t("form",{class:"bg-white flex flex-col px-12 py-8",onSubmit:s[0]||(s[0]=(...m)=>a(w)&&a(w)(...m))},[e(f),e(h,{name:"email"},{default:o(({componentField:m})=>[e(i,{class:"relative mb-8"},{default:o(()=>[s[1]||(s[1]=t("span",{class:"font-medium"},"メールアドレス",-1)),e(r,null,{default:o(()=>[e(n,F({type:"text",placeholder:"メールアドレス"},m),null,16)]),_:2},1024),e(l,{class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})]),_:2},1024)]),_:1}),e(h,{name:"password"},{default:o(({componentField:m})=>[e(i,{class:"relative mb-8"},{default:o(()=>[s[2]||(s[2]=t("span",{class:"font-medium"},"パスワード",-1)),e(r,null,{default:o(()=>[t("div",is,[e(n,F({type:a(u)?"text":"password",placeholder:"パスワード"},m),null,16,["type"]),t("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:$,"aria-label":"Toggle password visibility"},[a(u)?(d(),y(a(ns),{key:1,class:"h-5 w-3.5 text-black"})):(d(),y(a(as),{key:0,class:"h-5 w-3.5 text-black"}))])])]),_:2},1024),e(l,{class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})]),_:2},1024)]),_:1}),e(N,{type:"submit",class:"flex self-center"},{default:o(()=>[a(x)?(d(),y(a(I),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):os("",!0),s[3]||(s[3]=c(" ログイン "))]),_:1})],32),t("div",ms,[t("div",cs,[s[5]||(s[5]=c(" 初めての方は ")),e(E,{to:"/auth-mail",class:"hover:underline"},{default:o(()=>s[4]||(s[4]=[c("「新規登録」")])),_:1})]),t("div",us,[s[7]||(s[7]=c(" パスワードを忘れた場合は ")),e(E,{to:"/forgot-password",class:"hover:underline"},{default:o(()=>s[6]||(s[6]=[c("「こちら」")])),_:1})])])])])}}});export{Ss as default};
