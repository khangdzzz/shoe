import{t as O,o as G,s as S,m as z,f as T,u as D,F as H,_ as K,a as Q,c as U,b as W}from"./Bk2n7xKm.js";import{_ as X}from"./cGtsHAop.js";import{_ as Y}from"./CNVSGk8U.js";import{m as Z,z as ss,u as es,n as ts,r as x,A as as,J as os,F as g,M as r,c as ls,a as t,b as e,p as a,w as o,o as m,q as R,v as p,x as ns,d as $}from"./DGxLQE2y.js";import{u as is}from"./81YJSw_S.js";import{u as rs}from"./BOYK3-p7.js";import{E as P,a as M}from"./KDu9qgNz.js";import{L as ms}from"./CDNfbZ-T.js";import"./CsnMo2br.js";const ps={class:"login-page flex flex-col items-center justify-center h-[100vh]"},cs={class:"flex flex-col min-w-[500px] bg-white px-12 py-8"},fs={class:"relative"},us={class:"relative"},ds={class:"relative"},Es=Z({__name:"index",setup(xs){const B=ss(),L=es(),N=ts(),k=is(),{redirectPage:c}=rs(),n=B.query.token,_=x(!1),E=x(""),C=as(()=>N.notify);os(()=>{var s;n||c("/login"),k.checkTokenValid("password",(n==null?void 0:n.toString())??"");const l=k.parseJwt((n==null?void 0:n.toString())??"");(!l||(s=C.value)!=null&&s.message)&&setTimeout(()=>{c("/login")},1e3),E.value=(l==null?void 0:l.email)??"",J("email",E.value)});const f=x(!1),u=x(!1),j=()=>{f.value=!f.value},q=()=>{u.value=!u.value},A=O(G({email:S(z(g.email)).min(1,g.email),password:S(T(r.ERR001,g.password)).min(8,{message:r.ERR007}).max(50).regex(/^(?=.*\d).{8,}$/,{message:r.ERR007}),passwordConfirmation:S(T(r.ERR001,g.confirmPassword)).min(8,{message:r.ERR007}).max(50)}).refine(({password:l,passwordConfirmation:s})=>l===s,{message:r.ERR006,path:["passwordConfirmation"]})),{handleSubmit:I,setFieldValue:J}=D({validationSchema:A}),h=I(async l=>{var d;_.value=!0;const{password:s}=l;await L.resetPassword(s,n),(d=C.value)!=null&&d.message||c("/confirm-email-change-password"),_.value=!1});return(l,s)=>{const d=K,b=X,w=Q,y=U,v=H,F=W,V=Y;return m(),ls("div",ps,[s[9]||(s[9]=t("div",{class:"logo"},"LOGO",-1)),t("div",cs,[e(d),s[7]||(s[7]=t("h1",{class:"text-sm font-bold mb-[30px]"},"パスワード設定",-1)),s[8]||(s[8]=t("div",{class:"flex flex-col gap-2 mb-[30px]"},[t("p",{class:"text-xs"},"パスワードは英小文字、数字を含む、半角英数字８文字以上を設定してください。")],-1)),t("form",{class:"flex flex-col gap-[30px]",onSubmit:s[1]||(s[1]=(...i)=>a(h)&&a(h)(...i))},[e(v,{name:"email"},{default:o(({componentField:i})=>[e(y,{class:"relative"},{default:o(()=>[s[2]||(s[2]=t("span",{class:"font-medium"},"メールアドレス",-1)),e(w,null,{default:o(()=>[t("div",fs,[e(b,R({disabled:"",class:"bg-[#ccc]",placeholder:"メールアドレス"},i),null,16)])]),_:2},1024)]),_:2},1024)]),_:1}),e(v,{name:"password"},{default:o(({componentField:i})=>[e(y,{class:"relative"},{default:o(()=>[s[3]||(s[3]=t("span",{class:"font-medium"},"パスワード",-1)),e(w,null,{default:o(()=>[t("div",us,[e(b,R({type:a(f)?"text":"password",placeholder:"パスワード"},i),null,16,["type"]),t("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:j,"aria-label":"Toggle password visibility"},[a(f)?(m(),p(a(M),{key:1,class:"h-5 w-3.5 text-black"})):(m(),p(a(P),{key:0,class:"h-5 w-3.5 text-black"}))])])]),_:2},1024),e(F,{class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})]),_:2},1024)]),_:1}),e(v,{name:"passwordConfirmation"},{default:o(({componentField:i})=>[e(y,{class:"relative"},{default:o(()=>[s[4]||(s[4]=t("span",{class:"font-medium"},"パスワード（確認用）",-1)),e(w,null,{default:o(()=>[t("div",ds,[e(b,R({type:a(u)?"text":"password",placeholder:"パスワード（確認用）"},i),null,16,["type"]),t("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:q,"aria-label":"Toggle password visibility"},[a(u)?(m(),p(a(M),{key:1,class:"h-5 w-3.5 text-black"})):(m(),p(a(P),{key:0,class:"h-5 w-3.5 text-black"}))])]),e(F,{class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})]),_:2},1024)]),_:2},1024)]),_:1}),e(V,{type:"submit",class:"flex self-center w-[132px]"},{default:o(()=>[a(_)?(m(),p(a(ms),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):ns("",!0),s[5]||(s[5]=$(" 保存 "))]),_:1}),e(V,{class:"w-[132px]",variant:"cancel_btn",type:"button",onClick:s[0]||(s[0]=i=>a(c)("/login"))},{default:o(()=>s[6]||(s[6]=[$(" キャンセル ")])),_:1})],32)])])}}});export{Es as default};
