import{_ as G,a as O}from"./CuNwIUpc.js";import{t as D,u as H,F as K,_ as Q,a as U}from"./CJN3o0Fw.js";import{_ as W}from"./Dxesq19g.js";import{_ as X}from"./Czj0eQEe.js";import{_ as Y}from"./CvOqvOnz.js";import{o as Z,s as ss,a as es}from"./D1QClQyv.js";import{g as P}from"./ek3HdorF.js";import{m as ts,I as as,u as os,n as ls,r as p,z as ns,J as rs,F as $,M as v,c as is,a as e,b as t,p as a,w as o,o as i,q as S,v as m,x as k,d as B}from"./DIuhiDEr.js";import{u as ms}from"./BCnFCgog.js";import{u as ps}from"./CXOarpWc.js";import{E as M,a as N}from"./DPQCxREg.js";import{L as cs}from"./DA60YKYR.js";import"./CfT_0_Dv.js";import"./DlAUqK2U.js";const us={class:"login-page flex flex-col items-center justify-center h-[100vh]"},fs={class:"flex flex-col min-w-[500px] bg-white px-12 py-8"},ds={class:"relative"},_s={class:"relative"},xs={class:"relative"},$s=ts({__name:"index",setup(gs){const I=as(),L=os(),C=ls(),h=ms(),{redirectPage:c}=ps(),n=I.query.token,_=p(!1),x=p(!1),E=p(""),F=ns(()=>C.notify);rs(()=>{var s;n||c("/login"),h.checkTokenValid("password",(n==null?void 0:n.toString())??"");const l=h.parseJwt((n==null?void 0:n.toString())??"");(!l||(s=F.value)!=null&&s.message)&&setTimeout(()=>{c("/login")},1e3),E.value=(l==null?void 0:l.email)??"",z("email",E.value)});const u=p(!1),f=p(!1),j=()=>{u.value=!u.value},q=()=>{f.value=!f.value},J=D(Z({email:ss(es($.email)).min(1,$.email),password:P({message:v.ERR007}),passwordConfirmation:P({message:v.ERR007})}).refine(({password:l,passwordConfirmation:s})=>l===s,{message:v.ERR006,path:["passwordConfirmation"]})),{handleSubmit:A,setFieldValue:z}=H({validationSchema:J}),R=A(async l=>{var d;C.clearNotify(),x.value=!0;const{password:s}=l;await L.resetPassword(s,n),(d=F.value)!=null&&d.message||c("/confirm-email-change-password"),x.value=!1},()=>{_.value=!0});return(l,s)=>{const d=G,g=O,b=Q,y=U,w=K,V=W,T=X;return i(),is("div",us,[s[9]||(s[9]=e("div",{class:"logo mb-2"},[e("img",{src:Y,class:"h-[60px] w-auto"})],-1)),e("div",fs,[t(d),s[7]||(s[7]=e("h1",{class:"text-sm font-bold mb-[30px]"},"パスワード設定",-1)),s[8]||(s[8]=e("div",{class:"flex flex-col gap-2 mb-[30px]"},[e("p",{class:"text-xs"},"パスワードは英小文字、数字を含む、半角英数字８文字以上を設定してください。")],-1)),e("form",{class:"flex flex-col gap-[30px]",onSubmit:s[1]||(s[1]=(...r)=>a(R)&&a(R)(...r))},[t(w,{name:"email"},{default:o(({componentField:r})=>[t(y,{class:"relative"},{default:o(()=>[s[2]||(s[2]=e("span",{class:"font-medium"},"メールアドレス",-1)),t(b,null,{default:o(()=>[e("div",ds,[t(g,S({disabled:"",class:"bg-[#ccc]",placeholder:"メールアドレス"},r),null,16)])]),_:2},1024)]),_:2},1024)]),_:1}),t(w,{name:"password"},{default:o(({componentField:r})=>[t(y,{class:"relative"},{default:o(()=>[s[3]||(s[3]=e("span",{class:"font-medium"},"パスワード",-1)),t(b,null,{default:o(()=>[e("div",_s,[t(g,S({type:a(u)?"text":"password",placeholder:"パスワード"},r),null,16,["type"]),e("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:j,"aria-label":"Toggle password visibility"},[a(u)?(i(),m(a(N),{key:1,class:"h-5 w-3.5 text-black"})):(i(),m(a(M),{key:0,class:"h-5 w-3.5 text-black"}))])])]),_:2},1024),a(_)?(i(),m(V,{key:0,class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})):k("",!0)]),_:2},1024)]),_:1}),t(w,{name:"passwordConfirmation"},{default:o(({componentField:r})=>[t(y,{class:"relative"},{default:o(()=>[s[4]||(s[4]=e("span",{class:"font-medium"},"パスワード（確認用）",-1)),t(b,null,{default:o(()=>[e("div",xs,[t(g,S({type:a(f)?"text":"password",placeholder:"パスワード（確認用）"},r),null,16,["type"]),e("button",{type:"button",class:"absolute right-[15px] top-1/2 transform -translate-y-1/2",onClick:q,"aria-label":"Toggle password visibility"},[a(f)?(i(),m(a(N),{key:1,class:"h-5 w-3.5 text-black"})):(i(),m(a(M),{key:0,class:"h-5 w-3.5 text-black"}))])]),a(_)?(i(),m(V,{key:0,class:"absolute top-full left-0 mt-1 text-red-500 !m-[0px] !text-[12px] font-normal"})):k("",!0)]),_:2},1024)]),_:2},1024)]),_:1}),t(T,{type:"submit",class:"flex self-center w-[132px]"},{default:o(()=>[a(x)?(i(),m(a(cs),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):k("",!0),s[5]||(s[5]=B(" 保存 "))]),_:1}),t(T,{class:"w-[132px]",variant:"cancel_btn",type:"button",onClick:s[0]||(s[0]=r=>a(c)("/login"))},{default:o(()=>s[6]||(s[6]=[B(" キャンセル ")])),_:1})],32)])])}}});export{$s as default};
